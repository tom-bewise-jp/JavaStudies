# Javaプログラミング言語入門 (1)
## 計算するということ
プログラミング言語を学ぶ最初として、計算するとはどういうことかを考えてみます。

### 機械式の計算機を考える
100円ショップなどでも買える数取器 (カウンター) という道具があります。

4桁くらいの数字を表示する窓とボタンがあり、ボタンを押すごとに数字が1ずつ上がっていってボタンを押した数がわかるようになっているものです。

とりあえず数字を0にあわせて、ボタンを3回押すと3が表示されます。

そしてボタンを4回押すと表示は7に変わります。

実態としてはボタンを7回押しているのですが、形式的にはボタンを3回押して3を入力し、次にボタンを4回押して4を入力したら、結果として3と4を足した7が答えとして表示されたということになります。

例えば、ダイヤルで設定した数だけボタンを押す機構を用意して、ダイヤルに3と4を設定し、ボタン押しをスタートさせるようにすれば、3と4を足した結果として7が表示される計算機 (と言っても足し算しかできませんが) ができるわけです。

さて、普通の数取器には付いていないのですが、「減らす」ボタンがあるとどうなるかということを考えてみます。

7が表示されているところで「減らす」ボタンを4回押すと表示は3になります。

これは7から4を引いたら3になるということで、引き算もできるようになったということです。

ところで、3が表示されたところからもう一度「減らす」ボタンを4回押してみます。

3回「減らす」ボタンを押したところで表示は0になり、さらにもう1回押すと表示は最も大きな数字、4桁の数取器であれば9999が表示されると思います。

本来であれば-1を表示したいところですが、数取器にはマイナス表示がないので、4桁の数取器だと－1であれば9999、-2であれば9998というような値になります。これ補数 (より正確には10の補数) と呼びます。

先ほどはダイヤルで設定した数だけボタンを押す機構を考えましたが、今度はダイヤルで設定した数の補数だけボタンを押す機構を考えてみます。

足し算機構のダイヤルに7を設定し、補数機構のダイヤルに4を設定して「増やす」ボタンを押させてみましょう。

まず、足し算機構のダイヤル分だけ「増やす」ボタンが押されて7が表示されます。

次に補数機構がダイヤルに設定された4の補数、9996回「増やす」ボタンを押します。

すると数取器は1周回って0になった後、3を表示したところで止まります。

このように補数機構を用意すると「減らす」ボタンがなくとも引き算を行うことができるようになります。

このように足し算ができれば掛け算もできますし、少し面倒なところがありますが、足し算、引き算と掛け算ができれば割り算もできるようになります。

こうやって作られたのが機械式計算機です。

私は機械式計算機が飾られているのを見ただけで実際に使ったことはないのですが、電卓が普及する1960年代まで使われていたようです。

機械式計算機は複雑な計算を行おうとすると構造が複雑になるため、電気的な方法で計算するということが考えられました。

### 電気で計算する
機械的に作るのは割と簡単な数取器ですが、これを電気で作るのは少し面倒なので別の方法を考えてみます。

まず、0から9までの数字を書いたスイッチを横一列に並べて、それぞれのスイッチの一方の側をすべて電池のプラス極につなぎます。

次に0から9までの数字を書いたスイッチを縦一列に並べて同じようにそれぞれのスイッチの一方の側を電池のマイナス極につなぎます。

横列0のスイッチの電池につながっていない側と縦列0のスイッチの電池につながっていない側の間に電球をつないで0と書いておきます。

同じように横列1のスイッチの電池につながっていない側と縦列0のスイッチの電池につながっていない側の間に電球をつないで1と書いておきます。

次は横列0のスイッチの電池につながっていない側と縦列1のスイッチの電池につながっていない側とを1と書いた電球につなぎます。

これで縦列0と横列0のスイッチを入れると0と書かれた電球が点灯し、縦列1と横列0のスイッチ、または縦列0と横列1のスイッチを入れると1と書かれた電球が点灯するようになります。

同じように0から18までの19個の電球の数字が縦列のスイッチと横列のスイッチの数字の和になるようにつないでやると、縦列と横列のスイッチを入れることで足し算結果を電球が表示する足し算器ができます。

ただ、少し残念なことにこれでは1桁の足し算しかできません。

もちろん、縦横それぞれ0から99まであわせて200個のスイッチを用意して、0から198までの199個の電球を用意すれば2桁の足し算ができるようになりますが、3桁、4桁となると気が遠くなるようなスイッチの数になってしまいます。

そこでちょっとした工夫を行ってみます。

### 半加算器と全加算器

まず、2桁の数字が書かれた電球をやめて、10の位の電球1個と1の位の電球10個の組み合わせで結果を表示するようにします。

つまり、例えば13の電球につながっていた縦列6と横列7のスイッチを10の位の電球と1の位の6の電球が点灯するように線をつないでやります。

これで10の位の電球が点灯したら繰り上がりがあることがわかります。

1桁目はこれで十分ですが、2桁目以降は繰り上がりを受け取れるようにしなければなりません。

そのためにこれまで作った足し算器に加えて、繰り上がりがあった場合用の足し算器を用意します。

具体的には縦列、横列ともに0のスイッチがいれられた場合には1の電球が点灯するようにというように繰り上がり分を足した結果が表示されるようにした足し算器です。

次に電池のプラス極 (マイナス極でも構わない) とそれぞれの足し算器の間に切り替えスイッチを1個入れて、下の桁で繰り上がりがあった場合には電池が繰り上がり用足し算器につながり、繰り上がりがなかった場合には繰り上がりがない場合用足し算器につながるようにします。

このように作ってやると、何桁の計算であってもそれぞれの桁の数字をスイッチに設定し、1桁目から順次直下の桁の繰上りランプが点灯していれば繰り上がり用足し算器に電池がつながるようにスイッチを操作し、繰上りランプが点灯していなければ繰上りなし用足し算器に電池がつながるようにスイッチを操作することで正しい結果が得られるようになります。

これで大体はできあがりましたが、繰上りランプを見ながら操作するのは鬱陶しいのでもう一段の工夫を入れます。

繰り上がり用足し算器と繰上りなし用足し算器を切り替えるスイッチに鉄板を貼り付け、すぐそばに電磁石をおいて、電磁石に電気が流れるとスイッチに貼り付けた鉄板が引き寄せられて繰り上がり用足し算器が電池につながるように、電磁石に電気が流れていない場合にはスイッチが繰上りなし用足し算器に電気が流れるように作りこみます。

そして下の桁の繰上りランプの代わりに電磁石に電気が流れるようにすると、繰上りスイッチが自動的にオンオフされるので、値を設定するだけで足し算結果が表示されるようになります。

1桁の足し算器で、繰上りを受け取って足し算ができるものを全加算器、繰上りを受け取れないものを半加算器と呼んでいます。

また、電磁石を使って電気の力でスイッチを切り替える部品を継電器 (リレー) と呼び、リレーには共通接点 (コモン)、常開接点 (メーク)、常閉接点 (ブレーク) の3種類の接点があります。

リレーの電磁石に電気が流れている場合には共通接点と常開接点 (メーク) がつながり、電気が流れていない場合には共通接点と常閉接点 (ブレーク) がつながります。

### 2進数を使う

とりあえず足し算器を作ることができました。

しかし、1桁ごとに0から9までの値を設定し結果を表示しなければならないので線の数が10本ずつ必要になるという面倒さがあり、複雑な計算には向いていないという問題があります。

そこで、線の数を減らすために10進数ではなく2進数を使うということが考えられました。

2進数の場合は電気が流れていれば1、流れていなければ0というように1本の線で1桁を表現できるので、10進数と2進数の間の変換は必要になるものの10進数の計算機よりかなりシンプルに作ることができます。

ということで、まず2進数の半加算器を考えてみます。

| 入力1 | 入力2 | 繰上り桁 | 1桁目 |
| ----- | ----- | -------- | ----- |
|     0 |     0 |        0 |     0 |
|     0 |     1 |        0 |     1 |
|     1 |     0 |        0 |     1 |
|     1 |     1 |        1 |     0 |

まず、下1桁だけを見るとどちらか一方だけが1の場合に1になり、両方がともに0、あるいは1の場合には0になります。

そして繰上り桁は両方がともに1の場合にだけ1になります。

繰上り桁を作るのは割と簡単で、継電器を2個用意して、電池から片方の継電器の共通接点につなぎ、常開接点からもう一方の継電器の共通接点につなぎ、常開接点を出力とします。

これにより両方の継電器に電気が流れて両方の継電器の共通接点が常開接点につながることで出力に電気が流れるようになります。

下1桁の作り方は少し面倒です。

継電器を2個用意して、一方の継電器の共通接点に電池をつなぎ、その継電器の常開接点をもう一方の継電器の常閉接点に、常閉接点をもう一方の継電器の常開接点につないで、もう一方の継電器の共通接点を出力とします。

電池がつながっている側の継電器に電流が流れている場合、常開接点が共通接点につながっているので出力側継電器の常閉接点に電流が流れます。このため、出力側継電器に電気が流れない状態でないと共通接点に電気は流れません。

逆に電池がつながっている継電器に電気が流れていない場合には共通接点が常閉接点につながっているので出力側継電器の常開接点に電気が流れています。このため、出力側継電器に電流が流れていないと共通接点に出力は出ません。

このように継電器を4個使うことで半加算器を作ることができます。

次に全加算器を考えてみます。

| 繰上り | 入力1 | 入力2 | 繰上り桁 | 1桁目 |
| ----- | ----- | ------ | -------- | ----- |
| 0 | 0 | 0 | 0 | 0 |
| 0 | 0 | 1 | 0 | 1 |
| 0 | 1 | 0 | 0 | 1 |
| 0 | 1 | 1 | 1 | 0 |
| 1 | 0 | 0 | 0 | 1 |
| 1 | 0 | 1 | 1 | 0 |
| 1 | 1 | 0 | 1 | 0 |
| 1 | 1 | 1 | 1 | 1 |

今度は入力が3個になり、1桁目は3個の入力のうち1個に電気が流れている、あるいは3個の入力すべてに電気が流れていると出力され、繰上り桁は3個の入力のうち2個以上に電気が流れていると出力されます。

まず、繰上り桁から考えていきましょう。

繰上り入力に電気が来ていない場合、上の表の左端の列が0の場合ですが、入力1と入力2の両方に電気が来ている場合だけ電気が流れます。

まず、2個の継電器を用意して入力1で動作する継電器の常開接点と入力2で動作する継電器の常開接点を接続しておきます。これで入力1と入力2の両方に電気が来ている場合だけ電気が流れる回路ができます。

繰上り入力に電気が来ている場合、上の表で左端の列が1の場合には入力1と入力2の両方とも電気が来ていない場合だけ電気が流れません。

これを実現するために上とは別の2個の継電器を用意して入力1で動作する継電器の常開接点を入力2で動作する継電器の常開接点と常閉接点も両方に接続し、入力1で動作する継電器の常閉接点を入力2で動作する継電器の常開接点に接続します。こうすると両方の継電器の良平接点がつながっていないので、両方の継電器ともに電気が流れていない場合には電気が流れない回路ができます。

そして繰上り入力で動作する継電器を用意して、常閉接点には1個目の入力1と入力2の両方に電気が来ている場合だけ流れる回路をつなぎ、常開接点には2個目の入力1と入力2の両方に電気が来ていない場合だけ電気が流れない回路を接続します。

これで繰上り出力回路ができます。

